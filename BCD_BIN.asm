.INCLUDE "M16DE.INC"
.ORG 0
.DEF BIN_LSB,R22
.DEF BIN_MSB,R23

LDI R16,HIGH(RAMEND)
OUT SPH,R16
LDI R16,LOW(RAMEND)
OUT SPL,R16

CALL BCD_BIN

BCD_BIN:

LDS R20,0X63
STS 0X73,R20
LDS R20,0X62
STS 0X72,R20
LDS R20,0X61
STS 0X71,R20
LDS R20,0X60
STS 0X70,R20

otro:

LDS R20,0x73
CPI R20,0
BRNE DEC_BCD
LDS R20,0x72
CPI R20,0
BRNE DEC_BCD
LDS R20,0x71
CPI R20,0
BRNE DEC_BCD
LDS R20,0x70
CPI R20,0
BRNE DEC_BCD
RET

DEC_BCD:
LDI R17,9
LDI YL,0X73
LDI YH,0

ciclo:
LD R20,Y
DEC R20
ST Y,R20
CPI R20,0XFF
BRNE INC_BIN
ST Y,R17
DEC YL
CPI YL,0X6F
BRNE ciclo

INC_BIN:
INC BIN_LSB
CPI BIN_LSB,0
BRNE otro
INC BIN_MSB
RJMP otro


;----------BCD 3 DIGITOS A 8BITS---------;

BCD_BIN:

LDS R20,0X63
STS 0X73,R20
LDS R20,0X62
STS 0X72,R20
LDS R20,0X61
STS 0X71,R20

otro:

LDS R20,0x73
CPI R20,0
BRNE DEC_BCD
LDS R20,0x72
CPI R20,0
BRNE DEC_BCD
LDS R20,0x71
CPI R20,0
BRNE DEC_BCD
RET

DEC_BCD:
LDI R17,9
LDI YL,0X73
LDI YH,0

ciclo:
LD R20,Y
DEC R20
ST Y,R20
CPI R20,0XFF
BRNE INC_BIN
ST Y,R17
DEC YL
CPI YL,0X70
BRNE ciclo

INC_BIN:
INC BIN_LSB
CPI BIN_LSB,0
BRNE otro
RET


;----------BCD 6 DIGITOS A 24BITS---------;
BCD_BIN:

LDS R20,0X63
STS 0X73,R20
LDS R20,0X62
STS 0X72,R20
LDS R20,0X61
STS 0X71,R20
LDS R20,0X60
STS 0X70,R20
LDS R20,0X5F
STS 0X6F,R20
LDS R20,0X5E
STS 0X6E,R20


otro:

LDS R20,0x73
CPI R20,0
BRNE DEC_BCD
LDS R20,0x72
CPI R20,0
BRNE DEC_BCD
LDS R20,0x71
CPI R20,0
BRNE DEC_BCD
LDS R20,0x70
CPI R20,0
BRNE DEC_BCD
LDS R20,0x6F
CPI R20,0
BRNE DEC_BCD
LDS R20,0x6E
CPI R20,0
BRNE DEC_BCD
RET

DEC_BCD:
LDI R17,9
LDI YL,0X73
LDI YH,0

ciclo:
LD R20,Y
DEC R20
ST Y,R20
CPI R20,0XFF
BRNE INC_BIN
ST Y,R17
DEC YL
CPI YL,0X6D
BRNE ciclo

INC_BIN:
INC BIN_LSB
CPI BIN_LSB,0
BRNE otro
INC BIN_XLSB
CPI BIN_LSB,0
BRNE otro
INC BIN_XHSB
CPI BIN_LSB,0
BRNE otro
INC BIN_HSB
RJMP otro
