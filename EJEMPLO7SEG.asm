;CODIGO DE REFRESCAMIENTO DISPLAY 7 SEGMENTOS

INCLUDE "m16def.inc"
.ORG 0
RJMP MAIN

.ORG 0X26
RJMP RFSH


MAIN:
SER R16
OUT DDRB,R16
LDI R16,0b00000010
OUT TIMSK,R16
LDI R16,38
OUT OCR0,R16
LDI R16,0b00001101
OUT TCCR0,R16

;PREPARAR PUNTERO RAM DE DISPLAY
LDI XL,LOW(Ox60)
LDI XH,HIGH(0x60)
LDI R24,4
LDI R25,0b11101111

LDI R16,0
STS 0X60,R16
STS 0X61,R16
STS 0X62,R16
STS 0X63,R16
SEI

RFSH:
IN R20,SREG
PUSH R20 ;SALVAR EL ENTORNO

LD R0,X+
MOV R20,R25
ANDI R20,0XF0
ADD R0,R20
OUT PORTB,R0
ROL R25
DEC R24
BRNE SALIR
LDI XL,0X60
LDI XH,0X00
LDI R24,4
LDI R25,0b11101111

SALIR:
POP R20
OUT SREG,R20
RETI
